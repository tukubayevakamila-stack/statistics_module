import streamlit as st
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# ================== –ù–ê–°–¢–†–û–ô–ö–ò –°–¢–†–ê–ù–ò–¶–´ ==================
st.set_page_config(
    page_title="–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ",
    page_icon="üìä",
    layout="wide"
)

# ================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==================
def check_numeric_answer(true_value, user_value, tol=1e-6):
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å–ª–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ —Å –¥–æ–ø—É—Å–∫–æ–º tol.
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (bool, —Ç–µ–∫—Å—Ç_–æ–±—Ä–∞—Ç–Ω–æ–π_—Å–≤—è–∑–∏).
    """
    if user_value is None or user_value == "":
        return False, "–í–≤–µ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç."
    try:
        user_value = float(str(user_value).replace(",", "."))
    except ValueError:
        return False, "–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º."
    if abs(true_value - user_value) <= tol:
        return True, "‚úÖ –í–µ—Ä–Ω–æ!"
    else:
        return False, f"‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: {true_value}."


def calc_mode(series):
    """
    –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –º–æ–¥—ã: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –º–æ–¥ (–º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ).
    """
    counts = series.value_counts()
    max_count = counts.max()
    modes = counts[counts == max_count].index.tolist()
    return modes


def calc_variance_std(series):
    """
    –î–∏—Å–ø–µ—Ä—Å–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–ø–æ –ø—Ä–æ—Å—Ç–æ–π —à–∫–æ–ª—å–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ: –¥–µ–ª–µ–Ω–∏–µ –Ω–∞ n).
    """
    mean = series.mean()
    var = ((series - mean) ** 2).mean()
    std = np.sqrt(var)
    return var, std


def check_mcq_answer(true_option, user_option):
    """
    –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö —Å –≤—ã–±–æ—Ä–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–∞.
    """
    if not user_option:
        return False, "–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞."
    if user_option == true_option:
        return True, "‚úÖ –í–µ—Ä–Ω–æ!"
    else:
        return False, f"‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ¬´{true_option}¬ª."


# ================== –°–ê–ô–î–ë–ê–†: –ù–ê–í–ò–ì–ê–¶–ò–Ø ==================
st.sidebar.title("–ù–∞–≤–∏–≥–∞—Ü–∏—è")
page = st.sidebar.radio(
    "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–¥–µ–ª:",
    [
        "1. –¢–µ–æ—Ä–∏—è: –±–∞–∑–æ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è",
        "2. –ü—Ä–∏–º–µ—Ä—ã –∏ –∑–∞–¥–∞—á–∫–∏",
        "3. –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
        "4. –¢–µ—Å—Ç: 10 –∑–∞–¥–∞–Ω–∏–π",
        "5. –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏"
    ]
)

# ================== 1. –¢–ï–û–†–ò–Ø ==================
if page == "1. –¢–µ–æ—Ä–∏—è: –±–∞–∑–æ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è":
    st.title("üìä –≠–ª–µ–º–µ–Ω—Ç—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏")
    st.subheader("–ë–∞–∑–æ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è")

    st.markdown("""
**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî —ç—Ç–æ —Ä–∞–∑–¥–µ–ª –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–π –∏–∑—É—á–∞–µ—Ç —Å–±–æ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫—É, –∞–Ω–∞–ª–∏–∑ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö.

–í –Ω–∞—à–µ–º –º–æ–¥—É–ª–µ –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å:

- **–í—ã–±–æ—Ä–∫–æ–π** ‚Äî –Ω–∞–±–æ—Ä —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–æ—Å—Ç 20 —É—á–µ–Ω–∏–∫–æ–≤).
- **–°—Ä–µ–¥–Ω–∏–º –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–º** ‚Äî ¬´–æ–±—ã—á–Ω–∞—è¬ª —Å—Ä–µ–¥–Ω—è—è:
  
  \\[
  \\bar{x} = \\frac{x_1 + x_2 + \\dots + x_n}{n}
  \\]

- **–ú–æ–¥–æ–π** ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è **—á–∞—â–µ –≤—Å–µ–≥–æ**.
- **–ú–µ–¥–∏–∞–Ω–æ–π** ‚Äî ¬´—Å—Ä–µ–¥–Ω–∏–º¬ª –ø–æ –ø–æ—Ä—è–¥–∫—É –∑–Ω–∞—á–µ–Ω–∏–µ–º:
  - –ø—Ä–∏ –Ω–µ—á—ë—Ç–Ω–æ–º —á–∏—Å–ª–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç;
  - –ø—Ä–∏ —á—ë—Ç–Ω–æ–º ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –¥–≤—É—Ö —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö.
- **–†–∞–∑–º–∞—Ö–æ–º (–≤–∞—Ä–∏–∞—Ü–∏–µ–π)** ‚Äî —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –≤ –≤—ã–±–æ—Ä–∫–µ.
- **–î–∏—Å–ø–µ—Ä—Å–∏–µ–π** ‚Äî —Å—Ä–µ–¥–Ω–∏–º –∫–≤–∞–¥—Ä–∞—Ç–æ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ.
- **–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ–º** ‚Äî –∫–æ—Ä–Ω–µ–º –∏–∑ –¥–∏—Å–ø–µ—Ä—Å–∏–∏; –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª—å–Ω–æ –∑–Ω–∞—á–µ–Ω–∏—è ¬´—Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã¬ª –≤–æ–∫—Ä—É–≥ —Å—Ä–µ–¥–Ω–µ–≥–æ.
""")

    with st.expander("–ü—Ä–∏–º–µ—Ä: —Ä–æ—Å—Ç —É—á–µ–Ω–∏–∫–æ–≤ (—Å–º)"):
        st.latex("150,\\ 152,\\ 152,\\ 155,\\ 160,\\ 160,\\ 160,\\ 165")
        st.markdown("""
- –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ ‚Äî —Å—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π, –¥–µ–ª—ë–Ω–Ω–∞—è –Ω–∞ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ.  
- –ú–æ–¥–∞ ‚Äî **160**, —Ç.–∫. –æ–Ω–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ.  
- –ú–µ–¥–∏–∞–Ω–∞ ‚Äî —Å—Ä–µ–¥–Ω–µ–µ –æ—Ç –¥–≤—É—Ö —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (155 –∏ 160).  
- –†–∞–∑–º–∞—Ö ‚Äî —Ä–∞–∑–Ω–æ—Å—Ç—å –º–µ–∂–¥—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.  
- –î–∏—Å–ø–µ—Ä—Å–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞.
""")

    st.subheader("–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö")
    st.markdown("""
–î–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –≤–∏–¥–µ:

- **–¢–∞–±–ª–∏—Ü—ã —á–∞—Å—Ç–æ—Ç**
- **–°—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã**
- **–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã**
- **–ö—Ä—É–≥–æ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã** (–¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)

–î–∞–ª–µ–µ –º—ã –ø–æ—Ç—Ä–µ–Ω–∏—Ä—É–µ–º—Å—è —Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–∫–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö.
""")

# ================== 2. –ü–†–ò–ú–ï–†–´ –ò –¢–†–ï–ù–ò–†–û–í–û–ß–ù–´–ï –ó–ê–î–ê–ù–ò–Ø ==================
elif page == "2. –ü—Ä–∏–º–µ—Ä—ã –∏ –∑–∞–¥–∞—á–∫–∏":
    st.title("üßÆ –ü—Ä–∏–º–µ—Ä—ã –∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è")

    st.markdown("–í—ã–±–µ—Ä–∏ –æ–¥–Ω–æ –∏–∑ 10 –∑–∞–¥–∞–Ω–∏–π:")

    task_name = st.selectbox(
        "–ó–∞–¥–∞–Ω–∏–µ:",
        [
            "–ó–∞–¥–∞–Ω–∏–µ 1: –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ (–ø—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ)",
            "–ó–∞–¥–∞–Ω–∏–µ 2: –ú–µ–¥–∏–∞–Ω–∞",
            "–ó–∞–¥–∞–Ω–∏–µ 3: –ú–æ–¥–∞ (—á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ)",
            "–ó–∞–¥–∞–Ω–∏–µ 4: –†–∞–∑–º–∞—Ö (–≤–∞—Ä–∏–∞—Ü–∏—è)",
            "–ó–∞–¥–∞–Ω–∏–µ 5: –î–∏—Å–ø–µ—Ä—Å–∏—è (–ø–æ —Ñ–æ—Ä–º—É–ª–µ —Å –¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ n)",
            "–ó–∞–¥–∞–Ω–∏–µ 6: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ",
            "–ó–∞–¥–∞–Ω–∏–µ 7: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ ‚Ññ1 ‚Äî –∫–∞–∫–∞—è –∫–æ–ª–æ–Ω–∫–∞ –≤—ã—à–µ?",
            "–ó–∞–¥–∞–Ω–∏–µ 8: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ ‚Ññ2 ‚Äî –≤—ã–≤–æ–¥ –æ —Ä–∞–∑–±—Ä–æ—Å–µ",
            "–ó–∞–¥–∞–Ω–∏–µ 9: –°—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–∞–±–ª–∏—Ü–µ —á–∞—Å—Ç–æ—Ç",
            "–ó–∞–¥–∞–Ω–∏–µ 10: –í–ª–∏—è–Ω–∏–µ –≤—ã–±—Ä–æ—Å–∞ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω—É"
        ]
    )

    # ====== –ó–∞–¥–∞–Ω–∏–µ 1 ======
    if task_name == "–ó–∞–¥–∞–Ω–∏–µ 1: –°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ (–ø—Ä–æ—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ)":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 1. –ù–∞–π–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ")

        data = np.array([3, 5, 7, 5])
        st.markdown("–î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ (–±–∞–ª–ª—ã –∑–∞ –º–∏–Ω–∏-—Ç–µ—Å—Ç):")
        st.latex("3,\\ 5,\\ 7,\\ 5")

        true_mean = round(data.mean(), 2)

        ans = st.text_input("–í–≤–µ–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ", key="ex1")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 1"):
            ok, msg = check_numeric_answer(true_mean, ans, tol=0.01)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 2 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 2: –ú–µ–¥–∏–∞–Ω–∞":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 2. –ù–∞–π–¥–∏ –º–µ–¥–∏–∞–Ω—É")

        data = np.array([2, 4, 4, 6, 10])
        st.markdown("–î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ (–≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è, –º–∏–Ω):")
        st.latex("2,\\ 4,\\ 4,\\ 6,\\ 10")

        true_median = float(np.median(data))

        ans = st.text_input("–í–≤–µ–¥–∏ –º–µ–¥–∏–∞–Ω—É", key="ex2")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 2"):
            ok, msg = check_numeric_answer(true_median, ans, tol=0.01)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 3 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 3: –ú–æ–¥–∞ (—á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–µ–µ—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ)":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 3. –ù–∞–π–¥–∏ –º–æ–¥—É")

        data = np.array([8, 9, 9, 10, 7, 9])
        st.markdown("–î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ (–æ—Ü–µ–Ω–∫–∏ –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é):")
        st.latex("8,\\ 9,\\ 9,\\ 10,\\ 7,\\ 9")

        true_modes = calc_mode(pd.Series(data))

        ans = st.text_input("–í–≤–µ–¥–∏ –º–æ–¥—É (–µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ ‚Äî —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)", key="ex3")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 3"):
            try:
                user_modes = [int(x.strip()) for x in ans.split(",")]
                if sorted(user_modes) == sorted(true_modes):
                    st.info("‚úÖ –í–µ—Ä–Ω–æ! –ú–æ–¥–∞(—ã): " + ", ".join(map(str, true_modes)))
                else:
                    st.info("‚ùå –ù–µ–≤–µ—Ä–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–æ–¥–∞(—ã): " + ", ".join(map(str, true_modes)))
            except Exception:
                st.info("–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –≤–∏–¥–µ —á–∏—Å–µ–ª, —Ä–∞–∑–¥–µ–ª—ë–Ω–Ω—ã—Ö –∑–∞–ø—è—Ç—ã–º–∏.")

    # ====== –ó–∞–¥–∞–Ω–∏–µ 4 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 4: –†–∞–∑–º–∞—Ö (–≤–∞—Ä–∏–∞—Ü–∏—è)":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 4. –ù–∞–π–¥–∏ —Ä–∞–∑–º–∞—Ö (–≤–∞—Ä–∏–∞—Ü–∏—é)")

        data = np.array([12, 15, 20, 18, 17])
        st.markdown("–î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ (–∫–æ–ª-–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞—á):")
        st.latex("12,\\ 15,\\ 20,\\ 18,\\ 17")

        data_range = data.max() - data.min()

        ans = st.text_input("–í–≤–µ–¥–∏ —Ä–∞–∑–º–∞—Ö (max ‚àí min)", key="ex4")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 4"):
            ok, msg = check_numeric_answer(data_range, ans, tol=0.01)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 5 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 5: –î–∏—Å–ø–µ—Ä—Å–∏—è (–ø–æ —Ñ–æ—Ä–º—É–ª–µ —Å –¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ n)":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 5. –ù–∞–π–¥–∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é")

        st.markdown("""
–î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 1, 2, 3, 4.  
–°–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ, –∑–∞—Ç–µ–º –ø–æ —Ñ–æ—Ä–º—É–ª–µ  

\\[
D = \\frac{(x_1-\\bar x)^2 + \\dots + (x_n-\\bar x)^2}{n}
\\]

–≤—ã—á–∏—Å–ª–∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é (–¥–µ–ª–∏–º –Ω–∞ n).
""")

        data = np.array([1, 2, 3, 4])
        series = pd.Series(data)
        var_val, std_val = calc_variance_std(series)
        true_var = round(var_val, 2)  # 1.25

        ans = st.text_input("–í–≤–µ–¥–∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é", key="ex5")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 5"):
            ok, msg = check_numeric_answer(true_var, ans, tol=0.01)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 6 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 6: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 6. –ù–∞–π–¥–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ")

        st.markdown("""
–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ: 1, 2, 3, 4.  
–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏—è \\(D = 1{,}25\\).  
–ù–∞–π–¥–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ \\(\\sigma = \\sqrt{D}\\).
""")

        true_std = round(np.sqrt(1.25), 2)  # ‚âà 1.12

        ans = st.text_input("–í–≤–µ–¥–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (–æ–∫—Ä—É–≥–ª–∏ –¥–æ –¥–≤—É—Ö –∑–Ω–∞–∫–æ–≤)", key="ex6")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 6"):
            ok, msg = check_numeric_answer(true_std, ans, tol=0.02)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 7 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 7: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ ‚Ññ1 ‚Äî –∫–∞–∫–∞—è –∫–æ–ª–æ–Ω–∫–∞ –≤—ã—à–µ?":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 7. –†–∞–±–æ—Ç–∞ —Å –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–æ–π")

        st.markdown("""
–ù–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—Ä–µ–º—è (–≤ –º–∏–Ω—É—Ç–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ —É—á–µ–Ω–∏–∫–∏ —Ç—Ä–∞—Ç—è—Ç –Ω–∞ –¥–æ–º–∞—à–Ω—é—é —Ä–∞–±–æ—Ç—É –∑–∞ –¥–µ–Ω—å.
–í—ã–±–µ—Ä–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ.
""")

        data = np.array([10, 10, 20, 20, 20, 30, 30, 40])
        fig, ax = plt.subplots()
        ax.hist(data, bins=[0, 15, 30, 45], edgecolor="black")
        ax.set_xlabel("–ú–∏–Ω—É—Ç—ã")
        ax.set_ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
        ax.set_title("–í—Ä–µ–º—è –Ω–∞ –¥–æ–º–∞—à–Ω—é—é —Ä–∞–±–æ—Ç—É")
        st.pyplot(fig)

        ans = st.radio(
            "–ö–∞–∫–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ?",
            [
                "0‚Äì15 –º–∏–Ω—É—Ç",
                "15‚Äì30 –º–∏–Ω—É—Ç",
                "30‚Äì45 –º–∏–Ω—É—Ç"
            ],
            key="ex7"
        )

        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 7"):
            ok, msg = check_mcq_answer("15‚Äì30 –º–∏–Ω—É—Ç", ans)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 8 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 8: –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ ‚Ññ2 ‚Äî –≤—ã–≤–æ–¥ –æ —Ä–∞–∑–±—Ä–æ—Å–µ":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 8. –í—ã–≤–æ–¥ –ø–æ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ")

        st.markdown("""
–ù–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (–≤ —Ç—ã—Å—è—á–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ —É—á–µ–Ω–∏–∫–∏ –¥–µ–ª–∞—é—Ç –∑–∞ –¥–µ–Ω—å.
–°–¥–µ–ª–∞–π –≤—ã–≤–æ–¥ –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏.
""")

        data = np.array([5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10])
        fig, ax = plt.subplots()
        ax.hist(data, bins=[4.5, 6.5, 8.5, 10.5], edgecolor="black")
        ax.set_xlabel("–¢—ã—Å—è—á–∏ —à–∞–≥–æ–≤")
        ax.set_ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
        ax.set_title("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤")
        st.pyplot(fig)

        ans = st.radio(
            "–í—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:",
            [
                "–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤ –¥–µ–ª–∞–µ—Ç –º–µ–Ω–µ–µ 6 —Ç—ã—Å—è—á —à–∞–≥–æ–≤.",
                "–î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–æ–≤–æ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö –≤—ã–±—Ä–æ—Å–æ–≤.",
                "–ü–æ—á—Ç–∏ –≤—Å–µ —É—á–µ–Ω–∏–∫–∏ –¥–µ–ª–∞—é—Ç –±–æ–ª–µ–µ 10 —Ç—ã—Å—è—á —à–∞–≥–æ–≤."
            ],
            key="ex8"
        )

        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 8"):
            ok, msg = check_mcq_answer(
                "–î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–æ–≤–æ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö –≤—ã–±—Ä–æ—Å–æ–≤.",
                ans
            )
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 9 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 9: –°—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–∞–±–ª–∏—Ü–µ —á–∞—Å—Ç–æ—Ç":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 9. –°—Ä–µ–¥–Ω–µ–µ –ø–æ —Ç–∞–±–ª–∏—Ü–µ —á–∞—Å—Ç–æ—Ç")

        st.markdown("""
–î–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ –∑–∞ –º–µ—Å—è—Ü –∏ —á–∏—Å–ª–æ —É—á–µ–Ω–∏–∫–æ–≤.

| –ö–Ω–∏–≥ | –ß–∏—Å–ª–æ —É—á–µ–Ω–∏–∫–æ–≤ |
|------|----------------|
| 0    | 2              |
| 1    | 4              |
| 2    | 3              |
| 3    | 1              |

–ù–∞–π–¥–∏ **—Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥**, –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –æ–¥–Ω–∏–º —É—á–µ–Ω–∏–∫–æ–º.
""")

        values = np.array([0, 1, 2, 3])
        freqs = np.array([2, 4, 3, 1])
        data = np.repeat(values, freqs)
        true_mean = round(data.mean(), 2)

        ans = st.text_input("–í–≤–µ–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥", key="ex9")
        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 9"):
            ok, msg = check_numeric_answer(true_mean, ans, tol=0.01)
            st.info(msg)

    # ====== –ó–∞–¥–∞–Ω–∏–µ 10 ======
    elif task_name == "–ó–∞–¥–∞–Ω–∏–µ 10: –í–ª–∏—è–Ω–∏–µ –≤—ã–±—Ä–æ—Å–∞ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω—É":
        st.subheader("–ó–∞–¥–∞–Ω–∏–µ 10. –í–ª–∏—è–Ω–∏–µ –≤—ã–±—Ä–æ—Å–∞")

        st.markdown("""
–ò–∑–Ω–∞—á–∞–ª—å–Ω–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö (–º–∏–Ω—É—Ç—ã –≤ –¥–µ–Ω—å):  
30, 40, 45, 50, 55  

–ó–∞—Ç–µ–º –æ–¥–∏–Ω —É—á–µ–Ω–∏–∫ —Å—Ç–∞–ª –ø—Ä–æ–≤–æ–¥–∏—Ç—å 200 –º–∏–Ω—É—Ç –≤ –¥–µ–Ω—å, –∏ –º—ã –∑–∞–º–µ–Ω–∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ 55 –Ω–∞ 200.  

–ù—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç —Å–æ **—Å—Ä–µ–¥–Ω–∏–º** –∏ **–º–µ–¥–∏–∞–Ω–æ–π**.
""")

        ans = st.radio(
            "–í—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:",
            [
                "–°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞ —É–≤–µ–ª–∏—á–∞—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ.",
                "–°—Ä–µ–¥–Ω–µ–µ —Å–∏–ª—å–Ω–æ –≤—ã—Ä–∞—Å—Ç–µ—Ç, –∞ –º–µ–¥–∏–∞–Ω–∞ –ø–æ—á—Ç–∏ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è.",
                "–ú–µ–¥–∏–∞–Ω–∞ —Å–∏–ª—å–Ω–æ –≤—ã—Ä–∞—Å—Ç–µ—Ç, –∞ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ—á—Ç–∏ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è."
            ],
            key="ex10"
        )

        if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ 10"):
            ok, msg = check_mcq_answer(
                "–°—Ä–µ–¥–Ω–µ–µ —Å–∏–ª—å–Ω–æ –≤—ã—Ä–∞—Å—Ç–µ—Ç, –∞ –º–µ–¥–∏–∞–Ω–∞ –ø–æ—á—Ç–∏ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è.",
                ans
            )
            st.info(msg)

# ================== 3. –ê–ù–ê–õ–ò–ó –ì–û–¢–û–í–´–• –î–ê–ù–ù–´–• ==================
elif page == "3. –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö":
    st.title("üìä –ê–Ω–∞–ª–∏–∑ –≥–æ—Ç–æ–≤—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö")

    st.markdown("–í—ã–±–µ—Ä–∏ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:")

    dataset_name = st.selectbox(
        "–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:",
        ["–†–æ—Å—Ç —É—á–µ–Ω–∏–∫–æ–≤", "–ë–∞–ª–ª—ã –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é", "–í—Ä–µ–º—è –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö (–º–∏–Ω/–¥–µ–Ω—å)"]
    )

    if dataset_name == "–†–æ—Å—Ç —É—á–µ–Ω–∏–∫–æ–≤":
        data = np.array([150, 152, 155, 160, 158, 162, 165, 170, 168, 172])
        label = "–†–æ—Å—Ç (—Å–º)"
    elif dataset_name == "–ë–∞–ª–ª—ã –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é":
        data = np.array([6, 8, 9, 7, 10, 5, 8, 9, 7, 6, 8, 9])
        label = "–ë–∞–ª–ª—ã"
    else:
        data = np.array([60, 90, 120, 45, 30, 180, 150, 90, 75, 200])
        label = "–ú–∏–Ω—É—Ç—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö"

    st.subheader(f"–î–∞–Ω–Ω—ã–µ: {label}")
    st.write(data)

    series = pd.Series(data)
    mean_val = round(series.mean(), 2)
    median_val = float(np.median(series))
    modes = calc_mode(series)
    var_val, std_val = calc_variance_std(series)
    var_val_r = round(var_val, 2)
    std_val_r = round(std_val, 2)
    data_range = data.max() - data.min()

    col1, col2, col3, col4, col5 = st.columns(5)
    with col1:
        st.metric("–°—Ä–µ–¥–Ω–µ–µ", mean_val)
    with col2:
        st.metric("–ú–µ–¥–∏–∞–Ω–∞", median_val)
    with col3:
        st.metric("–ú–æ–¥–∞(—ã)", ", ".join(map(str, modes)))
    with col4:
        st.metric("–î–∏—Å–ø–µ—Ä—Å–∏—è", var_val_r)
    with col5:
        st.metric("–°—Ç–∞–Ω–¥. –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ", std_val_r)

    st.markdown(f"**–†–∞–∑–º–∞—Ö (–≤–∞—Ä–∏–∞—Ü–∏—è)**: {data_range}")

    st.markdown("### –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞")

    fig, ax = plt.subplots()
    ax.hist(data, bins="auto", edgecolor="black")
    ax.set_xlabel(label)
    ax.set_ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
    ax.set_title(f"–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: {label}")
    st.pyplot(fig)

    st.markdown("""
**–ü–æ–ø—Ä–æ–±—É–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å:**

- –ó–Ω–∞—á–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω—ã –≤ –∫–∞–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ?  
- –ï—Å—Ç—å –ª–∏ ¬´–≤—ã–±—Ä–æ—Å—ã¬ª ‚Äî —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è?  
- –°—Ä–µ–¥–Ω–µ–µ –∏ –º–µ–¥–∏–∞–Ω–∞ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –∏–ª–∏ –±–ª–∏–∑–∫–∏?  
- –ë–æ–ª—å—à–æ–µ –∏–ª–∏ –º–∞–ª–µ–Ω—å–∫–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ ‚Äî –¥–∞–Ω–Ω—ã–µ ¬´—Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã¬ª –∏–ª–∏ ¬´—Å–æ–±—Ä–∞–Ω—ã¬ª –æ–∫–æ–ª–æ —Å—Ä–µ–¥–Ω–µ–≥–æ?
""")

# ================== 4. –¢–ï–°–¢: 10 –ó–ê–î–ê–ù–ò–ô ==================
elif page == "4. –¢–µ—Å—Ç: 10 –∑–∞–¥–∞–Ω–∏–π":
    st.title("üìù –ò—Ç–æ–≥–æ–≤—ã–π —Ç–µ—Å—Ç –ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ (10 –∑–∞–¥–∞–Ω–∏–π)")

    st.markdown("""
–û—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã. –í –∑–∞–¥–∞–Ω–∏—è—Ö 1‚Äì6 –≤–≤–æ–¥–∏ **—á–∏—Å–ª–æ–≤–æ–π –æ—Ç–≤–µ—Ç**, –≤ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö ‚Äî –≤—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç.
–ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É **¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Å—Ç¬ª**.
""")

    st.subheader("–ó–∞–¥–∞–Ω–∏—è —Å —á–∏—Å–ª–æ–≤—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏")

    st.markdown("**1.** –î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 2, 4, 6, 8, 10. –ù–∞–π–¥–∏ **—Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ**.")
    q1 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 1", key="q1")

    st.markdown("**2.** –î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 1, 3, 3, 5, 7. –ù–∞–π–¥–∏ **–º–µ–¥–∏–∞–Ω—É**.")
    q2 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 2", key="q2")

    st.markdown("**3.** –î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 4, 4, 4, 5, 6, 6. –ù–∞–π–¥–∏ **–º–æ–¥—É**.")
    q3 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 3", key="q3")

    st.markdown("**4.** –î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 5, 8, 12, 20. –ù–∞–π–¥–∏ **—Ä–∞–∑–º–∞—Ö (–≤–∞—Ä–∏–∞—Ü–∏—é)** –≤—ã–±–æ—Ä–∫–∏ (max ‚àí min).")
    q4 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 4", key="q4")

    st.markdown("""
**5.** –î–∞–Ω—ã –¥–∞–Ω–Ω—ã–µ: 1, 2, 3, 4.  
–°–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥–∏ —Å—Ä–µ–¥–Ω–µ–µ, –∑–∞—Ç–µ–º –ø–æ —Ñ–æ—Ä–º—É–ª–µ  

\\[
D = \\frac{(x_1-\\bar x)^2 + \\dots + (x_n-\\bar x)^2}{n}
\\]

–≤—ã—á–∏—Å–ª–∏ **–¥–∏—Å–ø–µ—Ä—Å–∏—é** (–¥–µ–ª–∏–º –Ω–∞ n).
""")
    q5 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 5 (–¥–∏—Å–ø–µ—Ä—Å–∏—è)", key="q5")

    st.markdown("""
**6.** –î–ª—è —Ç–µ—Ö –∂–µ –¥–∞–Ω–Ω—ã—Ö: 1, 2, 3, 4 –Ω–∞–π–¥–∏ **—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ**  
(–∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å –∏–∑ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –≤ –∑–∞–¥–∞–Ω–∏–∏ 5 –¥–∏—Å–ø–µ—Ä—Å–∏–∏).
""")
    q6 = st.text_input("–û—Ç–≤–µ—Ç –∫ –∑–∞–¥–∞–Ω–∏—é 6 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ)", key="q6")

    st.subheader("–ó–∞–¥–∞–Ω–∏—è —Å –≤—ã–±–æ—Ä–æ–º –æ—Ç–≤–µ—Ç–∞ –∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞–º–∏")

    st.markdown("""
**7.** –ù–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—Ä–µ–º—è (–≤ –º–∏–Ω—É—Ç–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ —É—á–µ–Ω–∏–∫–∏ —Ç—Ä–∞—Ç—è—Ç –Ω–∞ –¥–æ–º–∞—à–Ω—é—é —Ä–∞–±–æ—Ç—É –∑–∞ –¥–µ–Ω—å.
–ü–æ –¥–∞–Ω–Ω—ã–º –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –≤—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è —á–∞—â–µ –≤—Å–µ–≥–æ?
""")

    data7 = np.array([10, 10, 20, 20, 20, 30, 30, 40])
    fig7, ax7 = plt.subplots()
    ax7.hist(data7, bins=[0, 15, 30, 45], edgecolor="black")
    ax7.set_xlabel("–ú–∏–Ω—É—Ç—ã")
    ax7.set_ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
    ax7.set_title("–í—Ä–µ–º—è –Ω–∞ –¥–æ–º–∞—à–Ω—é—é —Ä–∞–±–æ—Ç—É")
    st.pyplot(fig7)

    q7 = st.radio(
        "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç:",
        [
            "–û–∫–æ–ª–æ 10 –º–∏–Ω—É—Ç",
            "–û–∫–æ–ª–æ 20‚Äì25 –º–∏–Ω—É—Ç",
            "–û–∫–æ–ª–æ 40 –º–∏–Ω—É—Ç"
        ],
        key="q7"
    )

    st.markdown("""
**8.** –ù–∞ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º–µ –ø–æ–∫–∞–∑–∞–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (–≤ —Ç—ã—Å—è—á–∞—Ö), –∫–æ—Ç–æ—Ä–æ–µ —É—á–µ–Ω–∏–∫–∏ –¥–µ–ª–∞—é—Ç –∑–∞ –¥–µ–Ω—å.
–í—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö.
""")

    data8 = np.array([5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10])
    fig8, ax8 = plt.subplots()
    ax8.hist(data8, bins=[4.5, 6.5, 8.5, 10.5], edgecolor="black")
    ax8.set_xlabel("–¢—ã—Å—è—á–∏ —à–∞–≥–æ–≤")
    ax8.set_ylabel("–ß–∞—Å—Ç–æ—Ç–∞")
    ax8.set_title("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤")
    st.pyplot(fig8)

    q8 = st.radio(
        "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç:",
        [
            "–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —É—á–µ–Ω–∏–∫–æ–≤ –¥–µ–ª–∞–µ—Ç –º–µ–Ω–µ–µ 6 —Ç—ã—Å—è—á —à–∞–≥–æ–≤.",
            "–î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–æ–≤–æ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö –≤—ã–±—Ä–æ—Å–æ–≤.",
            "–ü–æ—á—Ç–∏ –≤—Å–µ —É—á–µ–Ω–∏–∫–∏ –¥–µ–ª–∞—é—Ç –±–æ–ª–µ–µ 10 —Ç—ã—Å—è—á —à–∞–≥–æ–≤."
        ],
        key="q8"
    )

    st.markdown("""
**9.** –ö –∫–∞–∂–¥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –≤—ã–±–æ—Ä–∫–∏ –ø—Ä–∏–±–∞–≤–∏–ª–∏ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —á–∏—Å–ª–æ 5.
–ö–∞–∫ –∏–∑–º–µ–Ω—è—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ?

–í—ã–±–µ—Ä–∏ –≤–µ—Ä–Ω–æ–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ.
""")

    q9 = st.radio(
        "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç:",
        [
            "–°—Ä–µ–¥–Ω–µ–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–∞ 5, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ç–æ–∂–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–∞ 5.",
            "–°—Ä–µ–¥–Ω–µ–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–∞ 5, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è.",
            "–°—Ä–µ–¥–Ω–µ–µ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è."
        ],
        key="q9"
    )

    st.markdown("""
**10.** –î–≤–∞ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

- –ù–∞–±–æ—Ä A: 5, 6, 7, 8, 9  
- –ù–∞–±–æ—Ä –ë: 1, 5, 9, 13, 17  

–í –∫–∞–∫–æ–º –Ω–∞–±–æ—Ä–µ **—Ä–∞–∑–±—Ä–æ—Å (–≤–∞—Ä–∏–∞—Ü–∏—è)** –±–æ–ª—å—à–µ?
""")

    q10 = st.radio(
        "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç:",
        [
            "–í –Ω–∞–±–æ—Ä–µ A",
            "–í –Ω–∞–±–æ—Ä–µ –ë",
            "–†–∞–∑–±—Ä–æ—Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π"
        ],
        key="q10"
    )

    if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ—Å—Ç"):
        correct = 0
        total = 10

        ans1 = 6
        ans2 = 3
        ans3 = 4
        ans4 = 15

        ok1, msg1 = check_numeric_answer(ans1, q1, tol=0.01)
        ok2, msg2 = check_numeric_answer(ans2, q2, tol=0.01)
        ok3, msg3 = check_numeric_answer(ans3, q3, tol=0.01)
        ok4, msg4 = check_numeric_answer(ans4, q4, tol=0.01)

        ans5 = 1.25
        ans6 = round(np.sqrt(1.25), 2)

        ok5, msg5 = check_numeric_answer(ans5, q5, tol=0.01)
        ok6, msg6 = check_numeric_answer(ans6, q6, tol=0.02)

        ok7, msg7 = check_mcq_answer("–û–∫–æ–ª–æ 20‚Äì25 –º–∏–Ω—É—Ç", q7)
        ok8, msg8 = check_mcq_answer("–î–∞–Ω–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–æ–≤–æ–ª—å–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö –≤—ã–±—Ä–æ—Å–æ–≤.", q8)
        ok9, msg9 = check_mcq_answer("–°—Ä–µ–¥–Ω–µ–µ —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–∞ 5, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è.", q9)
        ok10, msg10 = check_mcq_answer("–í –Ω–∞–±–æ—Ä–µ –ë", q10)

        results = [
            (1, ok1, msg1),
            (2, ok2, msg2),
            (3, ok3, msg3),
            (4, ok4, msg4),
            (5, ok5, msg5),
            (6, ok6, msg6),
            (7, ok7, msg7),
            (8, ok8, msg8),
            (9, ok9, msg9),
            (10, ok10, msg10),
        ]

        st.subheader("–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:")

        for num, ok, msg in results:
            if ok:
                st.success(f"–ó–∞–¥–∞–Ω–∏–µ {num}: {msg}")
                correct += 1
            else:
                st.error(f"–ó–∞–¥–∞–Ω–∏–µ {num}: {msg}")

        st.markdown(f"### –ò—Ç–æ–≥: {correct} –∏–∑ {total} –≤–µ—Ä–Ω–æ.")

# ================== 5. –ú–ï–¢–û–î–ò–ß–ï–°–ö–ò–ï –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò ==================
elif page == "5. –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏":
    st.title("üìò –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏")

    st.markdown("""
**–¶–µ–ª—å –º–æ–¥—É–ª—è** ‚Äî —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —É —É—á–∞—â–∏—Ö—Å—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ –∫–∞–∫ –æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–µ
–∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–º –ø—Ä–∏—ë–º–∞–º —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏ —É—á–µ–±–Ω—ã–º–∏ –≤—ã–±–æ—Ä–∫–∞–º–∏.

### –í–æ–∑–º–æ–∂–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- –§—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ —É—Ä–æ–∫–µ (—É—á–∏—Ç–µ–ª—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–∞ —ç–∫—Ä–∞–Ω–µ, —É—á–µ–Ω–∏–∫–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –æ—Ç–≤–µ—Ç—ã).
- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –∏ –ø–∞—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (—É—á–µ–Ω–∏–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∑–∞–¥–∞–Ω–∏—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö).
- –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –¥–∏—Å–∫—É—Å—Å–∏–µ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
- –ü—Ä–æ–µ–∫—Ç–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∞–Ω–∞–ª–∏–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–∞).

### –§–æ—Ä–º–∏—Ä—É–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏

- –†–∞–±–æ—Ç–∞ —Å –≤—ã–±–æ—Ä–∫–æ–π (—Å–±–æ—Ä, —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏–µ, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ).
- –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –º–æ–¥—ã, –º–µ–¥–∏–∞–Ω—ã, —Ä–∞–∑–º–∞—Ö–∞, –¥–∏—Å–ø–µ—Ä—Å–∏–∏ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è.
- –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —á–∞—Å—Ç–æ—Ç, –¥–∏–∞–≥—Ä–∞–º–º –∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º.
- –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤, —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ –≤—ã–≤–æ–¥–æ–≤.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

### –í–æ–∑–º–æ–∂–Ω—ã–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏

- –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥–∏–ø–æ—Ç–µ–∑ (t-–∫—Ä–∏—Ç–µ—Ä–∏–π, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö).
- –í—Å—Ç—Ä–æ–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫.
- –°–¥–µ–ª–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —É—Ä–æ–≤–Ω–µ–π: –±–∞–∑–æ–≤—ã–π, –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π.
- –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –≤ PDF/Excel.

–ú–æ–¥—É–ª—å –º–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∞—Å—Å, —É—á–µ–±–Ω–∏–∫ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.
""")
